namespace Domain.ValueObjects;

public class SecurityVulnerability {
    [MaxLength(128)]
    public string Id { get; set; } = string.Empty;
    [MaxLength(128)]
    public string Title { get; set; } = string.Empty;
    [MaxLength(2048)]
    public string Description { get; set; } = string.Empty;
    public SecurityScanSeverity Severity { get; set; }
    [MaxLength(128)]
    public string? CveId { get; set; }
    [MaxLength(128)]
    public string? Reference { get; set; }

    private SecurityVulnerability() { } // For EF Core

    public SecurityVulnerability(
        string id,
        string title,
        string description,
        SecurityScanSeverity severity,
        string? cveId = null,
        string? reference = null) {
        Id = !string.IsNullOrWhiteSpace(id) ? id : throw new ArgumentException("Id cannot be null or white space.", nameof(id));
        Title = !string.IsNullOrWhiteSpace(title) ? title : throw new ArgumentException("Title cannot be null or white space.", nameof(title));
        Description = !string.IsNullOrWhiteSpace(description) ? description : throw new ArgumentException("Description cannot be null or white space.", nameof(description));
        Severity = severity;
        CveId = cveId;
        Reference = reference;
    }
}